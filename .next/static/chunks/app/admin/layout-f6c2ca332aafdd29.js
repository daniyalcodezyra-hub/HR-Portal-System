(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[581],{407:(e,t,r)=>{"use strict";r.d(t,{default:()=>m});var s=r(5155),l=r(2115),a=r(6046),i=r(8173),n=r.n(i),c=r(5459),o=r(858),d=r(2823),h=r(4834),u=r(5236),x=r(853);let m=e=>{var t;let{children:r}=e;(0,a.useRouter)();let i=(0,a.usePathname)(),{signOut:m,user:p}=(0,c.A)(),[f,g]=(0,l.useState)(!1),y=[{label:"Today Summary",icon:(0,s.jsx)(o.A,{size:20}),path:"/admin"},{label:"Staff Registry",icon:(0,s.jsx)(d.A,{size:20}),path:"/admin/employees"},{label:"Monthly Logs",icon:(0,s.jsx)(h.A,{size:20}),path:"/admin/logs"}];return(0,s.jsxs)("div",{className:"flex min-h-screen bg-white selection:bg-black selection:text-white",children:[(0,s.jsx)("aside",{className:"hidden lg:flex fixed top-0 left-0 bottom-0 bg-white border-r border-zinc-100 z-50 w-28 flex-col justify-between",children:(0,s.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,s.jsx)("div",{className:"p-6 flex flex-col items-center gap-6 min-h-[100px]",children:(0,s.jsx)(n(),{href:"/",className:"w-10 h-10 bg-black rounded-xl flex items-center justify-center text-white font-black shrink-0 shadow-lg cursor-pointer hover:scale-105 transition-transform",children:"C"})}),(0,s.jsx)("nav",{className:"flex-1 px-3 py-4 space-y-4 flex flex-col items-center",children:y.map(e=>(0,s.jsxs)(n(),{href:e.path,title:e.label,className:"w-full flex flex-col items-center justify-center gap-2 py-4 rounded-xl transition-all duration-300 ".concat(i===e.path?"bg-black text-white shadow-xl shadow-zinc-200":"text-zinc-400 hover:text-black hover:bg-zinc-50"),children:[(0,s.jsx)("div",{className:"shrink-0",children:e.icon}),(0,s.jsx)("span",{className:"text-[9px] font-black uppercase tracking-widest text-center",children:e.label})]},e.path))}),(0,s.jsx)("div",{className:"p-4 border-t border-zinc-50 flex flex-col items-center",children:(0,s.jsxs)("button",{onClick:m,title:"Logout",className:"w-full flex flex-col items-center justify-center gap-2 py-4 text-zinc-400 hover:text-red-500 hover:bg-red-50 rounded-xl transition-all duration-300",children:[(0,s.jsx)("div",{className:"shrink-0",children:(0,s.jsx)(u.A,{size:20})}),(0,s.jsx)("span",{className:"text-[9px] font-black uppercase tracking-widest text-center",children:"Exit"})]})})]})}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col lg:pl-28 transition-all duration-300",children:[(0,s.jsxs)("header",{className:"h-20 lg:h-24 bg-white/80 backdrop-blur-md border-b border-zinc-100 px-6 lg:px-8 flex items-center justify-between sticky top-0 z-30",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"lg:hidden w-10 h-10 bg-black rounded-xl flex items-center justify-center text-white font-black shrink-0",children:"C"}),(0,s.jsxs)("div",{className:"hidden md:flex items-center bg-zinc-50 px-5 py-3 rounded-full w-64 lg:w-80 border border-zinc-200 focus-within:border-black transition-colors",children:[(0,s.jsx)(x.A,{size:16,className:"text-zinc-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Query database...",className:"bg-transparent border-none focus:ring-0 text-[10px] font-black uppercase tracking-widest ml-3 w-full text-black placeholder:text-zinc-400"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-6",children:[(0,s.jsxs)("div",{className:"hidden sm:flex flex-col text-right",children:[(0,s.jsxs)("p",{className:"text-[12px] font-black text-black leading-none uppercase tracking-tighter",children:[new Date().toLocaleTimeString("en-PK",{hour:"2-digit",minute:"2-digit",hour12:!1})," PKT"]}),(0,s.jsx)("p",{className:"text-[8px] text-zinc-400 font-black uppercase tracking-widest mt-1",children:"Operational Clock"})]}),(0,s.jsx)("div",{className:"h-8 w-px bg-zinc-100 hidden sm:block"}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"text-right hidden sm:block",children:[(0,s.jsx)("p",{className:"text-[10px] font-black text-black leading-none uppercase tracking-tighter",children:(null==p?void 0:p.full_name)||"Master Admin"}),(0,s.jsx)("p",{className:"text-[8px] text-zinc-400 font-black uppercase tracking-widest mt-1",children:(null==p?void 0:p.role)==="admin"?"Super User":"Employee"})]}),(0,s.jsx)("div",{className:"w-10 h-10 lg:w-11 lg:h-11 rounded-full bg-black flex items-center justify-center font-black text-white text-xs shadow-xl shadow-zinc-200 shrink-0",children:(null==p?void 0:null===(t=p.full_name)||void 0===t?void 0:t.split(" ").map(e=>e[0]).join("").toUpperCase())||"MA"})]})]})]}),(0,s.jsx)("main",{className:"p-4 md:p-8 lg:p-12 animate-in fade-in slide-in-from-bottom-4 duration-700 overflow-x-hidden",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto",children:r})})]})]})}},853:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(7401).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},858:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(7401).A)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},2823:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(7401).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},4834:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(7401).A)("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]])},5236:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(7401).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},5459:(e,t,r)=>{"use strict";r.d(t,{A:()=>o,AuthProvider:()=>c});var s=r(5155),l=r(2115),a=r(6046),i=r(2110);let n=(0,l.createContext)(void 0),c=e=>{let{children:t}=e,[r,c]=(0,l.useState)(null),[o,d]=(0,l.useState)(!0),h=(0,a.useRouter)(),u=async()=>{try{let e=await fetch("/api/auth/me"),t=await e.json();t.user?c(t.user):c(null)}catch(e){console.error("Check user error:",e),c(null)}finally{d(!1)}};(0,l.useEffect)(()=>{u()},[]);let x=async()=>{await u()},m=async e=>{try{let t=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok)return{error:null};return{error:r.error||"Signup failed"}}catch(e){return{error:e.message}}},p=async(e,t)=>{try{let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),s=await r.json();if(r.ok)return c(s.user),{error:null};return{error:s.error||"Login failed"}}catch(e){return{error:e.message}}},f=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),c(null),i.oR.info("Session Terminated. Offline."),h.push("/")}catch(e){console.error("Sign out error:",e)}};return(0,s.jsx)(n.Provider,{value:{user:r,loading:o,signUp:m,signIn:p,signOut:f,refreshUser:x},children:t})},o=()=>{let e=(0,l.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6046:(e,t,r)=>{"use strict";var s=r(6658);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},7401:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(2115);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:l=24,strokeWidth:n=2,absoluteStrokeWidth:c,className:o="",children:d,iconNode:h,...u}=e;return(0,s.createElement)("svg",{ref:t,...i,width:l,height:l,stroke:r,strokeWidth:c?24*Number(n)/Number(l):n,className:a("lucide",o),...u},[...h.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),c=(e,t)=>{let r=(0,s.forwardRef)((r,i)=>{let{className:c,...o}=r;return(0,s.createElement)(n,{ref:i,iconNode:t,className:a("lucide-".concat(l(e)),c),...o})});return r.displayName="".concat(e),r}},7831:(e,t,r)=>{Promise.resolve().then(r.bind(r,407)),Promise.resolve().then(r.bind(r,8981))},8981:(e,t,r)=>{"use strict";r.d(t,{ProtectedRoute:()=>n});var s=r(5155),l=r(2115),a=r(6046),i=r(5459);let n=e=>{let{children:t,allowedRoles:r,redirectTo:n="/login"}=e,{user:c,loading:o}=(0,i.A)(),d=(0,a.useRouter)();return((0,l.useEffect)(()=>{if(o||c){if(!o&&c&&r&&r.length>0&&!r.includes(c.role)){let e="admin"===c.role?"/admin":"/employee";d.push(e)}}else d.push(n)},[c,o,d,r,n]),o)?(0,s.jsxs)("div",{className:"flex justify-center items-center min-vh-100 bg-white",children:[(0,s.jsx)("div",{className:"spinner"}),(0,s.jsx)("p",{className:"ml-4",children:"Loading..."})]}):!c||r&&r.length>0&&!r.includes(c.role)?null:(0,s.jsx)(s.Fragment,{children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[110,441,587,358],()=>t(7831)),_N_E=e.O()}]);